$(document).on("click","#setup_worker .add",function(){function a(){if(!f.hasClass("busy")){d=!1;var b={user_ids:$.trim(e.val()),fields:"photo_50",v:5.2};b.user_ids&&(f.addClass("busy").next(".res").remove(),VK.api("users.get",b,function(b){f.removeClass("busy");b.response&&(b=b.response[0],f.after('<table class="res"><TR><TD class="photo"><IMG src='+b.photo_50+'><TD class="name">'+b.first_name+" "+b.last_name+"</table>"),d=b.id)}))}}function b(b,a){c.bottom.vkHint({msg:'<SPAN class="red">'+b+"</SPAN>",
remove:1,indent:40,show:1,top:a,left:92})}var c=_dialog({top:50,width:360,head:"Добавление нового сотрудника",content:'<div id="setup_worker_add"><h1>Ссылка на страницу или ID пользователя ВКонтакте:</h1><input type="text" /><DIV class="vkButton"><BUTTON>Найти</BUTTON></DIV></div>',butSubmit:"Добавить",submit:function(){if(d){var a={op:"setup_worker_add",id:d};c.process();$.post(AJAX_GAZ,a,function(a){c.abort();a.success?(c.close(),_msg("Новый сотрудник успешно добавлен."),$("#spisok").html(a.html)):
b(a.text,-60)},"json")}else b("Не выбран пользователь",-47)}}),d,e=c.content.find("input"),f=e.next();e.focus().keyEnter(a);f.click(a)}).on("click","#setup_worker .img_del",function(){for(var a=$(this);!a.hasClass("unit");)a=a.parent();var b=_dialog({top:110,width:250,head:"Удаление сотрудника",content:"<center>Подтвердите удаление сотрудника.</center>",butSubmit:"Удалить",submit:function(){var c={op:"setup_worker_del",viewer_id:a.attr("val")};b.process();$.post(AJAX_GAZ,c,function(a){a.success?(b.close(),
_msg("Сотрудник удален."),$("#spisok").html(a.html)):b.abort()},"json")}})}).on("click","#setup_gn .link",function(){var a=$(this),b={op:"setup_gn_spisok_get",year:a.html()};a.parent().find(".sel").removeClass("sel");a.addClass("sel");$.post(AJAX_GAZ,b,function(b){b.success&&$("#spisok").html(b.html)},"json")}).on("click","#setup_gn .vkButton",function(){function a(){var a={op:"setup_gn_spisok_create",year:c,week_nomer:$("#week_nomer").val(),general_nomer:$("#general_nomer").val(),day_print:$("#day_print").val(),
day_public:$("#day_public").val(),day_first:$("#day_first").val()};REGEXP_NUMERIC.test(a.week_nomer)?REGEXP_NUMERIC.test(a.general_nomer)?(d.process(),$.post(AJAX_GAZ,a,function(a){a.success?($("#dopLinks").html(a.year),$("#spisok").html(a.html),d.close(),_msg("Внесено!")):(d.abort(),b(a.text))},"json")):(b("Некорректно указан общий номер выпуска"),$("#general_nomer").focus()):(b("Некорректно указан номер недели выпуска"),$("#week_nomer").focus())}function b(b){d.bottom.vkHint({msg:"<SPAN class=red>"+
b+"</SPAN>",top:-47,left:58,indent:50,show:1,remove:1})}$(this);var c=$("#dopLinks .sel").html(),d=_dialog({top:60,width:310,head:"Создание списка номеров газеты",content:'<table class="setup-gn-tab"><tr><td colspan="2"><div class="gn-info">Для создания списка номеров газет <b>'+c+'</b> года укажите данные <b>первого номера</b>, который будет выходить в этом году.<br />Все поля обязательны для заполнения.</div><tr><td class="label">Первый номер выпуска:<td><input type="text" id="week_nomer" maxlength="2" value="1" /><input type="text" id="general_nomer" maxlength="4" value="'+
GN_MAX+'" /><tr><td class="label">Дни отправки в печать:<td><input type="hidden" id="day_print" value="1" /><tr><td class="label">Дни выхода:<td><input type="hidden" id="day_public" value="4" /><tr><td class="label">Первый день выхода:<td><input type="hidden" id="day_first" value="'+c+'-01-01" /></table>',butSubmit:"Создать",submit:a}),e=[{uid:0,title:"Понедельник"},{uid:1,title:"Вторник"},{uid:2,title:"Среда"},{uid:3,title:"Четверг"},{uid:4,title:"Пятница"},{uid:5,title:"Суббота"},{uid:6,title:"Воскресенье"}];
$("#week_nomer").focus();$("#week_nomer,#general_nomer").keyEnter(a);$("#day_print")._select({width:100,spisok:e});$("#day_public")._select({width:100,spisok:e});$("#day_first")._calendar({lost:1})}).on("click","#setup_gn .add",function(){function a(){var a={op:"setup_gn_add",week_nomer:$("#week_nomer").val(),general_nomer:$("#general_nomer").val(),day_print:$("#day_print").val(),day_public:$("#day_public").val(),year:$("#dopLinks .sel").html()};REGEXP_NUMERIC.test(a.week_nomer)?REGEXP_NUMERIC.test(a.general_nomer)?
(c.process(),$.post(AJAX_GAZ,a,function(a){a.success?($("#dopLinks").html(a.year),$("#spisok").html(a.html),c.close(),_msg("Внесено!")):(c.abort(),b(a.text))},"json")):(b("Некорректно указан общий номер выпуска"),$("#general_nomer").focus()):(b("Некорректно указан номер недели выпуска"),$("#week_nomer").focus())}function b(b){c.bottom.vkHint({msg:"<SPAN class=red>"+b+"</SPAN>",top:-47,left:58,indent:50,show:1,remove:1})}$(this);var c=_dialog({top:60,width:310,head:"Добавление номера газеты",content:'<table class="setup-gn-tab"><tr><td class="label r">Номер выпуска:<td><input type="text" id="week_nomer" maxlength="2" /><input type="text" id="general_nomer" maxlength="4" /><tr><td class="label r">День отправки в печать:<td><input type="hidden" id="day_print" /><tr><td class="label r">День выхода:<td><input type="hidden" id="day_public" /></table>',
submit:a});$("#week_nomer").focus();$("#week_nomer,#general_nomer").keyEnter(a);$("#day_print")._calendar({lost:1});$("#day_public")._calendar({lost:1})}).on("click","#setup_gn .img_edit",function(){function a(){var a={op:"setup_gn_edit",gn:e,week_nomer:$("#week_nomer").val(),general_nomer:$("#general_nomer").val(),day_print:$("#day_print").val(),day_public:$("#day_public").val(),year:$("#dopLinks .sel").html()};REGEXP_NUMERIC.test(a.week_nomer)?REGEXP_NUMERIC.test(a.general_nomer)?(g.process(),$.post(AJAX_GAZ,
a,function(a){a.success?($("#dopLinks").html(a.year),$("#spisok").html(a.html),g.close(),_msg("Изменено!")):(g.abort(),b(a.text))},"json")):(b("Некорректно указан общий номер выпуска"),$("#general_nomer").focus()):(b("Некорректно указан номер недели выпуска"),$("#week_nomer").focus())}function b(b){g.bottom.vkHint({msg:"<SPAN class=red>"+b+"</SPAN>",top:-47,left:58,indent:50,show:1,remove:1})}for(var c=$(this);"TR"!=c[0].tagName;)c=c.parent();var d=c.find(".nomer b").html(),e=c.find(".nomer span").html(),
f=c.find(".print s").html(),c=c.find(".pub s").html(),g=_dialog({top:60,width:310,head:"Редактирование номера газеты",content:'<table class="setup-gn-tab"><tr><td class="label r">Номер выпуска:<td><input type="text" id="week_nomer" maxlength="2" value="'+d+'" /><input type="text" id="general_nomer" maxlength="4"  value="'+e+'" /><tr><td class="label r">День отправки в печать:<td><input type="hidden" id="day_print" value="'+f+'" /><tr><td class="label r">День выхода:<td><input type="hidden" id="day_public" value="'+
c+'" /></table>',butSubmit:"Сохранить",submit:a});$("#week_nomer").focus();$("#week_nomer,#general_nomer").keyEnter(a);$("#day_print")._calendar({lost:1});$("#day_public")._calendar({lost:1})}).on("click","#setup_gn .img_del",function(){for(var a=$(this);"TR"!=a[0].tagName;)a=a.parent();var b=_dialog({top:90,width:300,head:"Удаление номера газеты",content:"<center>Подтвердите удаление номера газеты "+a.find(".nomer").html()+".</center>",butSubmit:"Удалить",submit:function(){var c={op:"setup_gn_del",
general:a.find(".nomer span").html(),year:$("#dopLinks .sel").html()};b.process();$.post(AJAX_GAZ,c,function(a){a.success?($("#dopLinks").html(a.year),$("#spisok").html(a.html),b.close(),_msg("Удалено!")):b.abort()},"json")}})}).on("click","#setup_person .add",function(){function a(){var a={op:"setup_person_add",name:$("#name").val()};a.name?(b.process(),$.post(AJAX_GAZ,a,function(a){a.success?($("#spisok").html(a.html),b.close(),_msg("Внесено!"),sortable()):b.abort()},"json")):(b.bottom.vkHint({msg:"<SPAN class=red>Не указано наименование</SPAN>",
top:-47,left:99,indent:50,show:1,remove:1}),$("#name").focus())}$(this);var b=_dialog({top:60,width:390,head:"Внесение новой категории",content:'<table class="setup-tab"><tr><td class="label">Наименование:<td><input id="name" type="text" maxlength="50" /></table>',submit:a});$("#name").focus().keyEnter(a)}).on("click","#setup_person .img_edit",function(){function a(){var b={op:"setup_person_edit",id:c,name:$("#name").val()};b.name?(d.process(),$.post(AJAX_GAZ,b,function(b){b.success?($("#spisok").html(b.html),
d.close(),_msg("Сохранено!"),sortable()):d.abort()},"json")):(d.bottom.vkHint({msg:"<SPAN class=red>Не указано наименование</SPAN>",top:-47,left:99,indent:50,show:1,remove:1}),$("#name").focus())}for(var b=$(this);"DD"!=b[0].tagName;)b=b.parent();var c=b.attr("val"),b='<table class="setup-tab"><tr><td class="label">Наименование:<td><input id="name" type="text" maxlength="50" value="'+b.find(".name").html()+'" /></table>',d=_dialog({top:60,width:390,head:"Редактирование категории клиентов",content:b,
butSubmit:"Сохранить",submit:a});$("#name").focus().keyEnter(a)}).on("click","#setup_person .img_del",function(){var a=$(this),b=_dialog({top:90,width:300,head:"Удаление категории клиента",content:"<center><b>Подтвердите удаление категории клиента.</b></center>",butSubmit:"Удалить",submit:function(){for(;"DD"!=a[0].tagName;)a=a.parent();var c={op:"setup_person_del",id:a.attr("val")};b.process();$.post(AJAX_GAZ,c,function(a){a.success?($("#spisok").html(a.html),b.close(),_msg("Удалено!"),sortable()):
b.abort()},"json")}})}).on("click","#setup_rubric .add",function(){function a(){var a={op:"setup_rubric_add",name:$("#name").val()};a.name?(b.process(),$.post(AJAX_GAZ,a,function(a){a.success?($("#spisok").html(a.html),b.close(),_msg("Внесено!"),sortable()):b.abort()},"json")):(b.bottom.vkHint({msg:"<SPAN class=red>Не указано наименование</SPAN>",top:-47,left:99,indent:50,show:1,remove:1}),$("#name").focus())}$(this);var b=_dialog({top:60,width:390,head:"Внесение новой рубрики",content:'<table class="setup-tab"><tr><td class="label">Наименование:<td><input id="name" type="text" maxlength="50" /></table>',
submit:a});$("#name").focus().keyEnter(a)}).on("click","#setup_rubric .img_edit",function(){function a(){var b={op:"setup_rubric_edit",id:c,name:$("#name").val()};b.name?(d.process(),$.post(AJAX_GAZ,b,function(b){b.success?($("#spisok").html(b.html),d.close(),_msg("Сохранено!"),sortable()):d.abort()},"json")):(d.bottom.vkHint({msg:"<SPAN class=red>Не указано наименование</SPAN>",top:-47,left:99,indent:50,show:1,remove:1}),$("#name").focus())}for(var b=$(this);"DD"!=b[0].tagName;)b=b.parent();var c=
b.attr("val"),b='<table class="setup-tab"><tr><td class="label">Наименование:<td><input id="name" type="text" maxlength="50" value="'+b.find(".name a").html()+'" /></table>',d=_dialog({top:60,width:390,head:"Редактирование рубрики",content:b,butSubmit:"Сохранить",submit:a});$("#name").focus().keyEnter(a)}).on("click","#setup_rubric .img_del",function(){var a=$(this),b=_dialog({top:90,width:300,head:"Удаление рубрики",content:"<center><b>Подтвердите удаление рубрики.</b></center>",butSubmit:"Удалить",
submit:function(){for(;"DD"!=a[0].tagName;)a=a.parent();var c={op:"setup_rubric_del",id:a.attr("val")};b.process();$.post(AJAX_GAZ,c,function(a){a.success?($("#spisok").html(a.html),b.close(),_msg("Удалено!"),sortable()):b.abort()},"json")}})}).on("click","#setup_rubric_sub .add",function(){function a(){var a={op:"setup_rubric_sub_add",rubric_id:RUBRIC_ID,name:$("#name").val()};a.name?(b.process(),$.post(AJAX_GAZ,a,function(a){a.success?($("#spisok").html(a.html),b.close(),_msg("Внесено!"),sortable()):
b.abort()},"json")):(b.bottom.vkHint({msg:"<SPAN class=red>Не указано наименование</SPAN>",top:-47,left:99,indent:50,show:1,remove:1}),$("#name").focus())}$(this);var b=_dialog({top:60,width:390,head:"Внесение новой подрубрики",content:'<table class="setup-tab"><tr><td class="label">Наименование:<td><input id="name" type="text" maxlength="50" /></table>',submit:a});$("#name").focus().keyEnter(a)}).on("click","#setup_rubric_sub .img_edit",function(){function a(){var b={op:"setup_rubric_sub_edit",id:c,
name:$("#name").val()};b.name?(d.process(),$.post(AJAX_GAZ,b,function(b){b.success?($("#spisok").html(b.html),d.close(),_msg("Сохранено!"),sortable()):d.abort()},"json")):(d.bottom.vkHint({msg:"<SPAN class=red>Не указано наименование</SPAN>",top:-47,left:99,indent:50,show:1,remove:1}),$("#name").focus())}for(var b=$(this);"DD"!=b[0].tagName;)b=b.parent();var c=b.attr("val"),b='<table class="setup-tab"><tr><td class="label">Наименование:<td><input id="name" type="text" maxlength="50" value="'+b.find(".name").html()+
'" /></table>',d=_dialog({top:60,width:390,head:"Редактирование подрубрики",content:b,butSubmit:"Сохранить",submit:a});$("#name").focus().keyEnter(a)}).on("click","#setup_rubric_sub .img_del",function(){var a=$(this),b=_dialog({top:90,width:300,head:"Удаление подрубрики",content:"<center><b>Подтвердите удаление подрубрики.</b></center>",butSubmit:"Удалить",submit:function(){for(;"DD"!=a[0].tagName;)a=a.parent();var c={op:"setup_rubric_sub_del",id:a.attr("val")};b.process();$.post(AJAX_GAZ,c,function(a){a.success?
($("#spisok").html(a.html),b.close(),_msg("Удалено!"),sortable()):b.abort()},"json")}})}).on("click","#setup_oblen .vkButton",function(){function a(b,a){$("#setup_oblen").vkHint({msg:"<SPAN class=red>Некорректный ввод</SPAN>",top:b,left:a,indent:50,show:1,remove:1})}var b=$(this),c={op:"setup_oblen",txt_len_first:$("#txt_len_first").val(),txt_cena_first:$("#txt_cena_first").val(),txt_len_next:$("#txt_len_next").val(),txt_cena_next:$("#txt_cena_next").val()};REGEXP_NUMERIC.test(c.txt_len_first)?REGEXP_NUMERIC.test(c.txt_cena_first)?
REGEXP_NUMERIC.test(c.txt_len_next)?REGEXP_NUMERIC.test(c.txt_cena_next)?(b.addClass("busy"),$.post(AJAX_GAZ,c,function(a){b.removeClass("busy");a.success&&_msg("Сохранено!")},"json")):(a(25,191),$("#txt_cena_next").focus()):(a(25,98),$("#txt_len_next").focus()):(a(-2,191),$("#txt_cena_first").focus()):(a(-2,98),$("#txt_len_first").focus())}).on("click","#setup_obdop .img_edit",function(){function a(){var b={op:"setup_obdop_edit",id:c,cena:$("#cena").val()};REGEXP_NUMERIC.test(b.cena)&&0!=b.cena?
(e.process(),$.post(AJAX_GAZ,b,function(b){b.success?($("#spisok").html(b.html),e.close(),_msg("Сохранено!")):e.abort()},"json")):(e.bottom.vkHint({msg:"<SPAN class=red>Некорректно указана цена</SPAN>",top:-47,left:99,indent:50,show:1,remove:1}),$("#cena").focus())}for(var b=$(this);"TR"!=b[0].tagName;)b=b.parent();var c=b.attr("val"),d=b.find(".name").html(),b=b.find(".cena").html(),e=_dialog({top:60,width:390,head:"Редактирование параметра",content:'<table class="setup-tab"><tr><td class="label">Наименование:<td><b>'+
d+'</b><tr><td class="label">Стоимость:<td><input id="cena" type="text" maxlength="6" value="'+b+'" /> руб.</table>',butSubmit:"Сохранить",submit:a});$("#cena").keyEnter(a)}).on("click","#setup_polosa .add",function(){function a(){var a={op:"setup_polosa_add",name:$("#name").val(),cena:$("#cena").val()};a.name?REGEXP_CENA.test(a.cena)?(c.process(),$.post(AJAX_GAZ,a,function(b){b.success?($("#spisok").html(b.html),c.close(),_msg("Внесено!"),sortable()):c.abort()},"json")):(b("Некорректно указана цена"),
$("#cena").focus()):(b("Не указано наименование"),$("#name").focus())}function b(b){c.bottom.vkHint({msg:"<SPAN class=red>"+b+"</SPAN>",top:-47,left:99,indent:50,show:1,remove:1})}$(this);var c=_dialog({top:60,width:390,head:"Внесение новой полосы",content:'<table class="setup-tab"><tr><td class="label">Наименование:<td><input id="name" type="text" maxlength="50" /><tr><td class="label">Цена за см&sup2;:<td><input id="cena" type="text" maxlength="6" /> руб.</table>',submit:a});$("#name").focus();
$("#name,#cena").keyEnter(a)}).on("click","#setup_polosa .img_edit",function(){function a(){var a={op:"setup_polosa_edit",id:d,name:$("#name").val(),cena:$("#cena").val()};a.name?REGEXP_CENA.test(a.cena)?(f.process(),$.post(AJAX_GAZ,a,function(b){b.success?($("#spisok").html(b.html),f.close(),_msg("Сохранено!"),sortable()):f.abort()},"json")):(b("Некорректно указана цена"),$("#cena").focus()):(b("Не указано наименование"),$("#name").focus())}function b(b){f.bottom.vkHint({msg:"<SPAN class=red>"+b+
"</SPAN>",top:-47,left:99,indent:50,show:1,remove:1})}for(var c=$(this);"DD"!=c[0].tagName;)c=c.parent();var d=c.attr("val"),e=c.find(".name").html(),c=c.find(".cena").html(),f=_dialog({top:60,width:390,head:"Редактирование данных полосы",content:'<table class="setup-tab"><tr><td class="label">Наименование:<td><input id="name" type="text" maxlength="50" value="'+e+'" /><tr><td class="label">Цена за см&sup2;:<td><input id="cena" type="text" maxlength="6" value="'+c+'" /> руб.</table>',butSubmit:"Сохранить",
submit:a});$("#name").focus();$("#name,#cena").keyEnter(a)}).on("click","#setup_invoice .add",function(){function a(){var a={op:"setup_invoice_add",name:$("#name").val(),about:$("#about").val(),types:$("#types").val()};a.name?(c.process(),$.post(AJAX_GAZ,a,function(a){a.success?($(".spisok").html(a.html),c.close(),_msg("Внесено!")):(c.abort(),b(a.text))},"json")):(b("Не указано наименование"),$("#name").focus())}function b(b){c.bottom.vkHint({msg:"<SPAN class=red>"+b+"</SPAN>",top:-47,left:100,indent:50,
show:1,remove:1})}$(this);var c=_dialog({width:400,head:"Добавление нового счёта",content:'<table class="setup-tab"><tr><td class="label">Наименование:<td><input id="name" type="text" maxlength="50" /><tr><td class="label topi">Описание:<td><textarea id="about"></textarea><tr><td class="label topi">Виды платежей:<td><input type="hidden" id="types" /></table>',submit:a});$("#name").focus().keyEnter(a);$("#types")._select({width:218,multiselect:1,spisok:INCOME_SPISOK})}).on("click","#setup_invoice .img_edit",
function(){function a(){var a={op:"setup_invoice_edit",id:d,name:$("#name").val(),about:$("#about").val(),types:$("#types").val()};a.name?(g.process(),$.post(AJAX_GAZ,a,function(a){a.success?($(".spisok").html(a.html),g.close(),_msg("Сохранено!")):(g.abort(),b(a.text))},"json")):(b("Не указано наименование"),$("#name").focus())}function b(b){g.bottom.vkHint({msg:"<SPAN class=red>"+b+"</SPAN>",top:-47,left:100,indent:50,show:1,remove:1})}for(var c=$(this);"TR"!=c[0].tagName;)c=c.parent();var d=c.attr("val"),
e=c.find(".name div").html(),f=c.find(".name pre").html(),c=c.find(".type_id").val(),g=_dialog({width:400,head:"Редактирование данных счёта",content:'<table class="setup-tab"><tr><td class="label r">Наименование:<td><input id="name" type="text" maxlength="100" value="'+e+'" /><tr><td class="label r top">Описание:<td><textarea id="about">'+f+'</textarea><tr><td class="label topi">Виды платежей:<td><input type="hidden" id="types" value="'+c+'" /></table>',butSubmit:"Сохранить",submit:a});$("#name").focus().keyEnter(a);
$("#types")._select({width:218,multiselect:1,spisok:INCOME_SPISOK})}).on("click","#setup_invoice .img_del",function(){var a=$(this),b=_dialog({top:90,width:300,head:"Удаление счёта",content:"<center><b>Подтвердите удаление счёта.</b></center>",butSubmit:"Удалить",submit:function(){for(;"TR"!=a[0].tagName;)a=a.parent();var c={op:"setup_invoice_del",id:a.attr("val")};b.process();$.post(AJAX_GAZ,c,function(a){a.success?($(".spisok").html(a.html),b.close(),_msg("Удалено!")):b.abort()},"json")}})}).on("click",
"#setup_money .add",function(){function a(){var a={op:"setup_money_add",name:$("#name").val()};a.name?(b.process(),$.post(AJAX_GAZ,a,function(a){a.success?($("#spisok").html(a.html),b.close(),_msg("Внесено!"),sortable()):b.abort()},"json")):(b.bottom.vkHint({msg:"<SPAN class=red>Не указано наименование</SPAN>",top:-47,left:99,indent:50,show:1,remove:1}),$("#name").focus())}$(this);var b=_dialog({top:60,width:390,head:"Внесение новой вида платежа",content:'<table class="setup-tab"><tr><td class="label">Наименование:<td><input id="name" type="text" maxlength="100" /></table>',
submit:a});$("#name").focus().keyEnter(a)}).on("click","#setup_money .img_edit",function(){function a(){var a={op:"setup_money_edit",id:c,name:$("#name").val()};a.name?(d.process(),$.post(AJAX_GAZ,a,function(a){a.success?($("#spisok").html(a.html),d.close(),_msg("Сохранено!"),sortable()):d.abort()},"json")):(d.bottom.vkHint({msg:"<SPAN class=red>Не указано наименование</SPAN>",top:-47,left:99,indent:50,show:1,remove:1}),$("#name").focus())}for(var b=$(this);"DD"!=b[0].tagName;)b=b.parent();var c=
b.attr("val"),b='<table class="setup-tab"><tr><td class="label">Наименование:<td><input id="name" type="text" maxlength="100" value="'+b.find(".name").html()+'" /></table>',d=_dialog({top:60,width:390,head:"Редактирование вида платежа",content:b,butSubmit:"Сохранить",submit:a});$("#name").focus().keyEnter(a)}).on("click","#setup_money .img_del",function(){var a=$(this),b=_dialog({top:90,width:300,head:"Удаление вида платежа",content:"<center><b>Подтвердите удаление вида платежа.</b></center>",butSubmit:"Удалить",
submit:function(){for(;"DD"!=a[0].tagName;)a=a.parent();var c={op:"setup_money_del",id:a.attr("val")};b.process();$.post(AJAX_GAZ,c,function(a){a.success?($("#spisok").html(a.html),b.close(),_msg("Удалено!"),sortable()):b.abort()},"json")}})}).on("click","#setup_skidka .add",function(){function a(){var a={op:"setup_skidka_add",razmer:$("#razmer").val(),about:$("#about").val()};!REGEXP_NUMERIC.test(a.razmer)||0==a.razmer||100<a.razmer?(b.bottom.vkHint({msg:"<SPAN class=red>Некорректно указан размер скидки</SPAN>",
top:-47,left:99,indent:50,show:1,remove:1}),$("#razmer").focus()):(b.process(),$.post(AJAX_GAZ,a,function(a){a.success?($("#spisok").html(a.html),b.close(),_msg("Внесено!")):b.abort()},"json"))}$(this);var b=_dialog({top:60,width:390,head:"Внесение новой скидки",content:'<table class="setup-tab"><tr><td class="label">Размер:<td><input id="razmer" type="text" maxlength="3" /> %<tr><td class="label">Описание:<td><input id="about" type="text" maxlength="200" /></table>',submit:a});$("#razmer").focus();
$("#razmer,#about").keyEnter(a)}).on("click","#setup_skidka .img_edit",function(){function a(){var a={op:"setup_skidka_edit",razmer:c,about:$("#about").val()};!REGEXP_NUMERIC.test(a.razmer)||0==a.razmer||100<a.razmer?(d.bottom.vkHint({msg:"<SPAN class=red>Некорректно указан размер скидки</SPAN>",top:-47,left:99,indent:50,show:1,remove:1}),$("#razmer").focus()):(d.process(),$.post(AJAX_GAZ,a,function(a){a.success?($("#spisok").html(a.html),d.close(),_msg("Сохранено!")):d.abort()},"json"))}for(var b=
$(this);"TR"!=b[0].tagName;)b=b.parent();var c=b.find(".razmer b").html(),b=b.find(".about").html(),d=_dialog({top:60,width:390,head:"Редактирование скидки",content:'<table class="setup-tab"><tr><td class="label">Размер:<td><b>'+c+'</b>%<tr><td class="label">Описание:<td><input id="about" type="text" maxlength="200" value="'+b+'" /></table>',butSubmit:"Сохранить",submit:a});$("#razmer").focus();$("#razmer,#about").keyEnter(a)}).on("click","#setup_skidka .img_del",function(){var a=$(this),b=_dialog({top:90,
width:300,head:"Удаление скидки",content:"<center><b>Подтвердите удаление скидки.</b></center>",butSubmit:"Удалить",submit:function(){for(;"TR"!=a[0].tagName;)a=a.parent();var c={op:"setup_skidka_del",razmer:a.find(".razmer b").html()};b.process();$.post(AJAX_GAZ,c,function(a){a.success?($("#spisok").html(a.html),b.close(),_msg("Удалено!")):b.abort()},"json")}})}).on("click","#setup_expense .add",function(){function a(){var a={op:"setup_expense_add",name:$("#name").val(),show_worker:$("#show_worker").val()};
a.name?(b.process(),$.post(AJAX_GAZ,a,function(a){a.success?($("#spisok").html(a.html),b.close(),_msg("Внесено!"),sortable()):b.abort()},"json")):(b.bottom.vkHint({msg:"<SPAN class=red>Не указано наименование</SPAN>",top:-47,left:99,indent:50,show:1,remove:1}),$("#name").focus())}$(this);var b=_dialog({top:60,width:390,head:"Внесение новой категории расхода",content:'<table class="setup-tab"><tr><td class="label">Наименование:<td><input id="name" type="text" maxlength="200" /><tr><td class="label r">Список сотрудников:<td><input id="show_worker" type="hidden" /></table>',
submit:a});$("#name").focus().keyEnter(a);$("#show_worker")._check()}).on("click","#setup_expense .img_edit",function(){function a(){var a={op:"setup_rashod_edit",id:c,name:$("#name").val(),show_worker:$("#show_worker").val()};a.name?(e.process(),$.post(AJAX_GAZ,a,function(a){a.success?($("#spisok").html(a.html),e.close(),_msg("Сохранено!"),sortable()):e.abort()},"json")):(e.bottom.vkHint({msg:"<SPAN class=red>Не указано наименование</SPAN>",top:-47,left:99,indent:50,show:1,remove:1}),$("#name").focus())}
for(var b=$(this);"DD"!=b[0].tagName;)b=b.parent();var c=b.attr("val"),d=b.find(".name").html(),b=b.find(".worker").html()?1:0,e=_dialog({width:390,head:"Редактирование категории расхода",content:'<table class="setup-tab"><tr><td class="label">Наименование:<td><input id="name" type="text" maxlength="200" value="'+d+'" /><tr><td class="label r">Список сотрудников:<td><input id="show_worker" type="hidden" value="'+b+'" /></table>',butSubmit:"Сохранить",submit:a});$("#name").focus().keyEnter(a);$("#show_worker")._check()}).on("click",
"#setup_expense .img_del",function(){var a=$(this),b=_dialog({top:90,width:300,head:"Удаление категории расхода",content:"<center><b>Подтвердите удаление категории расхода.</b></center>",butSubmit:"Удалить",submit:function(){for(;"DD"!=a[0].tagName;)a=a.parent();var c={op:"setup_rashod_del",id:a.attr("val")};b.process();$.post(AJAX_GAZ,c,function(a){a.success?($("#spisok").html(a.html),b.close(),_msg("Удалено!"),sortable()):b.abort()},"json")}})});
